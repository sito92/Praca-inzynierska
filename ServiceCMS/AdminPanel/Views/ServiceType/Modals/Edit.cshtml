@using Modules.Resources
@using Logic.Common.Models
<div class="modal-header">
    <div class="row text-center">
        <h2 class="text-modal-heading">@Presentation.Edit</h2>
    </div>
</div>
<div class="modal-body">
    <ul dnd-list="list">
        <!-- The dnd-draggable directive makes an element draggable and will
             transfer the object that was assigned to it. If an element was
             dragged away, you have to remove it from the original list
             yourself using the dnd-moved attribute -->
        <li ng-repeat="item in models.list"
            dnd-draggable="item"
            dnd-moved="list.splice($index, 1)"
            dnd-effect-allowed="move"
            dnd-selected="models.selected = item"
            ng-class="{'selected': models.selected === item}">
            {{item.label}}
        </li>
    </ul>
    <div class="form-group form-field row">
        <div class="col-md-3">
            <label class="control-label">@Presentation.Name</label>
        </div>
        <div class="col-md-9">
            <input class="form-control" ng-model="serviceType.Name" />
        </div>
    </div>
    <div class="form-group form-field row">
        <div class="col-md-12">
            <div class="dnd-list" dnd-list="serviceType.Phases">
                <div ng-repeat="phase in serviceType.Phases"
                     dnd-draggable="phase"
                     dnd-moved="serviceType.Phases.splice($index, 1)"
                     dnd-effect-allowed="move"
                     class="phases-container">
                    <div class="row phase-container">
                        <div class="col-md-3">
                            <div class="handle">:::</div>
                            <label class="control-label">@Presentation.Phase {{$index + 1 }}</label>
                        </div>
                        <div class="col-md-9">
                            <div class="row input-container">
                                <div class="col-md-3">
                                    <label class="control-label">@Presentation.Name</label>
                                </div>
                                <div class="col-md-9">
                                    <input dnd-nodrag class="form-control" ng-model="phase.Name" />
                                </div>
                            </div>
                            <div class="row input-container">
                                <div class="col-md-3">
                                    <label class="control-label">@Presentation.DurationInMinutes</label>
                                </div>
                                <div class="col-md-9">
                                    <input dnd-nodrag class="form-control" ng-model="phase.DurationInSeconds" />
                                </div>
                            </div>
                            <div class="row input-container">
                                <div class="col-md-3">
                                    <label class="control-label">@Presentation.DelayInMinutes</label>
                                </div>
                                <div class="col-md-9">
                                    <input dnd-nodrag class="form-control" ng-model="phase.DelayInSeconds" />
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="phase-buttons pull-right">
                        <button class="btn btn-sm btn-default" ng-show="serviceType.Phases.length>1" ng-click="remove($index)"><span class="glyphicon glyphicon-remove text-danger"></span></button>
                        <button class="btn btn-sm btn-default" ng-click="add($index)"><span class="glyphicon glyphicon-plus text-success"></span></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal-footer">
    <button class="btn btn-primary" ng-click="save()">@Presentation.Edit</button>
    <button class="btn btn-default" ng-click="cancel()">@Presentation.Cancel</button>
</div>
